<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python ë°ì´í„° ë¶„ì„ ì‹¤ìŠµ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.26.0/plotly.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 0;
            min-height: calc(100vh - 200px);
        }
        
        .sidebar {
            background: #f8f9fa;
            padding: 20px;
            border-right: 2px solid #e0e0e0;
            overflow-y: auto;
        }
        
        .step {
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 4px solid transparent;
        }
        
        .step:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .step.active {
            border-left-color: #667eea;
            background: #f0f4ff;
        }
        
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 10px;
            font-weight: bold;
        }
        
        .content-area {
            padding: 30px;
            overflow-y: auto;
        }
        
        .step-content {
            display: none;
        }
        
        .step-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 2em;
        }
        
        h3 {
            color: #764ba2;
            margin: 20px 0 10px 0;
        }
        
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            line-height: 1.6;
        }
        
        .code-block .comment {
            color: #6272a4;
        }
        
        .code-block .keyword {
            color: #ff79c6;
        }
        
        .code-block .function {
            color: #50fa7b;
        }
        
        .code-block .string {
            color: #f1fa8c;
        }
        
        .interactive-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px solid #667eea;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: transform 0.2s;
            margin: 5px;
        }
        
        button:hover {
            transform: scale(1.05);
        }
        
        button:active {
            transform: scale(0.95);
        }
        
        button.danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        }
        
        button.success {
            background: linear-gradient(135deg, #28a745 0%, #218838 100%);
        }
        
        input[type="file"], input[type="text"], input[type="number"] {
            margin: 10px 5px;
            padding: 10px;
            border: 2px solid #667eea;
            border-radius: 5px;
            font-size: 1em;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background: #667eea;
            color: white;
            font-weight: bold;
        }
        
        tr:hover {
            background: #f5f5f5;
        }
        
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            min-height: 400px;
        }
        
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        
        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        
        select {
            padding: 10px;
            border-radius: 5px;
            border: 2px solid #667eea;
            font-size: 1em;
            margin: 10px 5px;
        }
        
        .output-area {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            min-height: 100px;
            border: 2px dashed #ccc;
        }
        
        .missing-options {
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 10px;
        }
        
        .missing-options label {
            display: block;
            margin: 10px 0;
            cursor: pointer;
        }
        
        .missing-options input[type="radio"] {
            margin-right: 10px;
        }
        
        .column-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .column-item {
            background: white;
            padding: 10px;
            border-radius: 5px;
            border: 2px solid #e0e0e0;
        }
        
        .column-item.has-missing {
            border-color: #dc3545;
            background: #fff5f5;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ Python ë°ì´í„° ë¶„ì„ ì‹¤ìŠµ</h1>
            <p class="subtitle">ë‹¨ê³„ë³„ë¡œ ë”°ë¼í•˜ë©° ë°°ìš°ëŠ” ë°ì´í„° ë¶„ì„</p>
        </header>
        
        <div class="main-content">
            <div class="sidebar">
                <div class="step active" data-step="1">
                    <span class="step-number">1</span>
                    <span>ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</span>
                </div>
                <div class="step" data-step="2">
                    <span class="step-number">2</span>
                    <span>ë°ì´í„° í™•ì¸</span>
                </div>
                <div class="step" data-step="3">
                    <span class="step-number">3</span>
                    <span>ê²°ì¸¡ì¹˜ ì²˜ë¦¬</span>
                </div>
                <div class="step" data-step="4">
                    <span class="step-number">4</span>
                    <span>ê¸°ì´ˆ í†µê³„ ë¶„ì„</span>
                </div>
                <div class="step" data-step="5">
                    <span class="step-number">5</span>
                    <span>ë°ì´í„° ê°€ê³µ/ë³€í™˜</span>
                </div>
                <div class="step" data-step="6">
                    <span class="step-number">6</span>
                    <span>ë°ì´í„° ì‹œê°í™”</span>
                </div>
            </div>
            
            <div class="content-area">
                <!-- Step 1: ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° -->
                <div class="step-content active" id="step1">
                    <h2>ğŸ“ 1ë‹¨ê³„: ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</h2>
                    
                    <div class="info-box">
                        <strong>ğŸ’¡ í•™ìŠµ ëª©í‘œ:</strong> CSV íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ê³  pandas DataFrameìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ë°©ë²•ì„ ë°°ì›ë‹ˆë‹¤.
                    </div>
                    
                    <div class="code-block">
<p><span class="comment"># ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°</span></p>
<p><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</p>
<p><span class="keyword">import</span> numpy <span class="keyword">as</span> np</p>
<p><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</p>
<p><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</p>

<p><span class="comment"># CSV íŒŒì¼ ì½ê¸°</span></p>
<p><p>df = pd.<span class="function">read_csv</span>(<span class="string">"íŒŒì¼ì´ë¦„.csv"</span>, encoding=<span class="string">"utf-8"</span>)</p></p>
                    </div>
                    
                    <div class="interactive-section">
                        <h3>ì‹¤ìŠµ: CSV íŒŒì¼ ì—…ë¡œë“œí•˜ê¸°</h3>
                        <input type="file" id="csvFile" accept=".csv">
                        <button class="success" onclick="loadSampleData()">ìƒ˜í”Œ ë°ì´í„° ì‚¬ìš©í•˜ê¸°</button>
                        <div class="output-area" id="loadOutput">íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.</div>
                    </div>
                </div>
                
                <!-- Step 2: ë°ì´í„° í™•ì¸ -->
                <div class="step-content" id="step2">
                    <h2>ğŸ” 2ë‹¨ê³„: ë°ì´í„° í™•ì¸</h2>
                    
                    <div class="info-box">
                        <strong>ğŸ’¡ í•™ìŠµ ëª©í‘œ:</strong> head(), info() ë“±ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ì˜ êµ¬ì¡°ì™€ ë‚´ìš©ì„ íŒŒì•…í•©ë‹ˆë‹¤.
                    </div>
                    
                    <div class="code-block">
<p><span class="comment"># ìƒìœ„ 5í–‰ í™•ì¸</span></p>
<p>df.<span class="function">head</span>()</p>

<p><span class="comment"># ë°ì´í„° ì •ë³´ í™•ì¸ (ë°ì´í„° íƒ€ì…, ê²°ì¸¡ì¹˜ í™•ì¸)</span></p>
<p>df.<span class="function">info</span>()</p>

<p><span class="comment"># ë°ì´í„° í¬ê¸° í™•ì¸</span></p>
<p>df.<span class="function">shape</span></p>
                    </div>
                    
                    <div class="interactive-section">
                        <h3>ì‹¤ìŠµ: ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°</h3>
                        <button onclick="showHead()">df.head() ì‹¤í–‰</button>
                        <button onclick="showInfo()">df.info() ì‹¤í–‰</button>
                        <button onclick="showShape()">ë°ì´í„° í¬ê¸° í™•ì¸</button>
                        <div class="output-area" id="previewOutput"></div>
                    </div>
                </div>
                
                <!-- Step 3: ê²°ì¸¡ì¹˜ ì²˜ë¦¬ -->
                <div class="step-content" id="step3">
                    <h2>ğŸ”§ 3ë‹¨ê³„: ê²°ì¸¡ì¹˜ ì²˜ë¦¬</h2>
                    
                    <div class="info-box">
                        <strong>ğŸ’¡ í•™ìŠµ ëª©í‘œ:</strong> ê²°ì¸¡ì¹˜ë¥¼ í™•ì¸í•˜ê³  ì‚­ì œí•˜ê±°ë‚˜ ì±„ìš°ëŠ” ë°©ë²•ì„ ë°°ì›ë‹ˆë‹¤.
                    </div>
                    
                    <div class="code-block">
<p><p><span class="comment"># ê²°ì¸¡ì¹˜ ê°œìˆ˜ í™•ì¸</span></p>
<p>df.<span class="function">isna</span>().<span class="function">sum</span>()</p>


<p><span class="comment"># ê²°ì¸¡ì¹˜ ì‚­ì œ (í–‰ ë‹¨ìœ„)</span></p>
<p>df.<span class="function">dropna</span>(axis=0, inplace=<span class="keyword">True</span>)</p>


<p><span class="comment"># ê²°ì¸¡ì¹˜ë¥¼ 0ìœ¼ë¡œ ì±„ìš°ê¸°</span></p>
<p>df.<span class="function">fillna</span>(0, inplace=<span class="keyword">True</span>)</p>


<p><span class="comment"># íŠ¹ì • ì»¬ëŸ¼ë§Œ ì¤‘ì•™ê°’ìœ¼ë¡œ ì±„ìš°ê¸°</span></p>
<p>df[<span class="string">"ë‚˜ì´"</span>].<span class="function">fillna</span>(df[<span class="string">"ë‚˜ì´"</span>].<span class="function">median</span>(), inplace=<span class="keyword">True</span>)</p>
                    </div>
                    
                    <div class="interactive-section">
                        <h3>ì‹¤ìŠµ: ê²°ì¸¡ì¹˜ ì²˜ë¦¬í•˜ê¸°</h3>
                        <button onclick="checkMissing()">1. ê²°ì¸¡ì¹˜ í™•ì¸</button>
                        
                        <div id="missingDisplay" style="display:none;">
                            <div class="warning-box">
                                <strong>âš ï¸ ê²°ì¸¡ì¹˜ê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤!</strong>
                                <p>ì•„ë˜ì—ì„œ ì²˜ë¦¬ ë°©ë²•ì„ ì„ íƒí•˜ì„¸ìš”.</p>
                            </div>
                            
                            <div class="missing-options">
                                <h4>ì²˜ë¦¬ ë°©ë²• ì„ íƒ:</h4>
                                <label>
                                    <input type="radio" name="missingMethod" value="drop" checked>
                                    <strong>ê²°ì¸¡ì¹˜ ì‚­ì œ (dropna)</strong> - ê²°ì¸¡ì¹˜ê°€ ìˆëŠ” í–‰ ì „ì²´ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.
                                </label>
                                <label>
                                    <input type="radio" name="missingMethod" value="fillZero">
                                    <strong>0ìœ¼ë¡œ ì±„ìš°ê¸° (fillna)</strong> - ëª¨ë“  ê²°ì¸¡ì¹˜ë¥¼ 0ìœ¼ë¡œ ì±„ì›ë‹ˆë‹¤.
                                </label>
                                <label>
                                    <input type="radio" name="missingMethod" value="fillMean">
                                    <strong>í‰ê· ê°’ìœ¼ë¡œ ì±„ìš°ê¸°</strong> - ìˆ˜ì¹˜í˜• ì»¬ëŸ¼ì˜ ê²°ì¸¡ì¹˜ë¥¼ í‰ê· ê°’ìœ¼ë¡œ ì±„ì›ë‹ˆë‹¤.
                                </label>
                                <button onclick="applyMissingTreatment()">ì„ íƒí•œ ë°©ë²•ìœ¼ë¡œ ì²˜ë¦¬</button>
                            </div>
                        </div>
                        
                        <div class="output-area" id="missingOutput"></div>
                    </div>
                </div>
                
                <!-- Step 4: ê¸°ì´ˆ í†µê³„ -->
                <div class="step-content" id="step4">
                    <h2>ğŸ“Š 4ë‹¨ê³„: ê¸°ì´ˆ í†µê³„ ë¶„ì„</h2>
                    
                    <div class="info-box">
                        <strong>ğŸ’¡ í•™ìŠµ ëª©í‘œ:</strong> describe(), mean(), median() ë“±ìœ¼ë¡œ ë°ì´í„°ì˜ í†µê³„ì  íŠ¹ì„±ì„ íŒŒì•…í•©ë‹ˆë‹¤.
                    </div>
                    
                    <div class="code-block">
<p><p><span class="comment"># ê¸°ì´ˆ í†µê³„ëŸ‰ í™•ì¸</span></p></p>
<p>df.<span class="function">describe</span>()</p>


<p><span class="comment"># íŠ¹ì • ì»¬ëŸ¼ì˜ í‰ê· , ì¤‘ì•™ê°’</span></p>
<p>df[<span class="string">"ì»¬ëŸ¼ëª…"</span>].<span class="function">mean</span>()</p>
<p>df[<span class="string">"ì»¬ëŸ¼ëª…"</span>].<span class="function">median</span>()</p>


<p><span class="comment"># ë²”ì£¼í˜• ë°ì´í„° íƒìƒ‰</span></p>
<p>df[<span class="string">"ì»¬ëŸ¼ëª…"</span>].<span class="function">unique</span>()          <span class="comment"># ê³ ìœ ê°’ í™•ì¸</span></p>
<p>df[<span class="string">"ì»¬ëŸ¼ëª…"</span>].<span class="function">value_counts</span>()    <span class="comment"># ê³ ìœ ê°’ë³„ ë¹ˆë„ìˆ˜</span></p>


<p><span class="comment"># ìƒê´€ê³„ìˆ˜ ê³„ì‚°</span></p>
<p>df.<span class="function">corr</span>()</p>
                    </div>
                    
                    <div class="interactive-section">
                        <h3>ì‹¤ìŠµ: í†µê³„ ë¶„ì„í•˜ê¸°</h3>
                        <button onclick="showDescribe()">describe() ì‹¤í–‰</button>
                        <button onclick="showCorrelation()">ìƒê´€ê³„ìˆ˜ ê³„ì‚° ë° íˆíŠ¸ë§µ</button>
                        <select id="columnSelect" onchange="showColumnStats()">
                            <option value="">ì»¬ëŸ¼ ì„ íƒ</option>
                        </select>
                        <button onclick="showColumnStats()">ì„ íƒ ì»¬ëŸ¼ í†µê³„</button>
                        <div class="output-area" id="statsOutput"></div>
                    </div>
                </div>
                
                <!-- Step 5: ë°ì´í„° ê°€ê³µ -->
                <div class="step-content" id="step5">
                    <h2>âš™ï¸ 5ë‹¨ê³„: ë°ì´í„° ê°€ê³µ/ë³€í™˜</h2>
                    
                    <div class="info-box">
                        <strong>ğŸ’¡ í•™ìŠµ ëª©í‘œ:</strong> ë°ì´í„° íƒ€ì… ë³€í™˜, ìƒˆë¡œìš´ ì»¬ëŸ¼ ìƒì„±, ê·¸ë£¹í•‘ ë“±ì„ ë°°ì›ë‹ˆë‹¤.
                    </div>
                    
                    <div class="code-block">
<p><span class="comment"># 1. ë°ì´í„° íƒ€ì… ë³€í™˜</span></p>
<p>df[<span class="string">"ìˆ˜ì¹˜ì»¬ëŸ¼"</span>] = df[<span class="string">"ìˆ˜ì¹˜ì»¬ëŸ¼"</span>].<span class="function">astype</span>(int)</p>
<p>df[<span class="string">"ë‚ ì§œì»¬ëŸ¼"</span>] = pd.<span class="function">to_datetime</span>(df[<span class="string">"ë‚ ì§œì»¬ëŸ¼"</span>])</p>


<p><span class="comment"># 2. ìƒˆë¡œìš´ ì»¬ëŸ¼ ìƒì„± (íŒŒìƒ ë³€ìˆ˜)</span></p>
<p>df[<span class="string">"ìƒˆì»¬ëŸ¼"</span>] = df[<span class="string">"ì»¬ëŸ¼A"</span>] / df[<span class="string">"ì»¬ëŸ¼B"</span>]</p>


<p><span class="comment"># ì¡°ê±´ì— ë”°ë¥¸ ë²”ì£¼í˜• ì»¬ëŸ¼ ìƒì„±</span></p>
<p>bins = [0, 20, 40, 60, 100]</p>
<p>labels = [<span class="string">"~19"</span>, <span class="string">"20-39"</span>, <span class="string">"40-59"</span>, <span class="string">"60+"</span>]</p>
<p>df[<span class="string">"ì—°ë ¹ëŒ€"</span>] = pd.<span class="function">cut</span>(df[<span class="string">"ë‚˜ì´"</span>], bins=bins, labels=labels)</p>


<p><span class="comment"># 3. ë°ì´í„° ë³‘í•©</span></p>
<p>pd.<span class="function">merge</span>(df1, df2, on=<span class="string">"í‚¤ì»¬ëŸ¼"</span>, how=<span class="string">"inner"</span>)    <span class="comment"># ìˆ˜ì§ ë³‘í•©</span></p>
<p>pd.<span class="function">concat</span>([df1, df2], axis=0)                      <span class="comment"># ìˆ˜í‰ ë³‘í•©</span></p>


<p><span class="comment"># 4. ê·¸ë£¹í•‘ ë° ì§‘ê³„ (Group By)</span></p>
<p>agg_data = df.<span class="function">groupby</span>(<span class="string">"ê·¸ë£¹ì»¬ëŸ¼"</span>)[<span class="string">"ì§‘ê³„ì»¬ëŸ¼"</span>].<span class="function">agg</span>([<span class="string">"mean"</span>, <span class="string">"sum"</span>, <span class="string">"count"</span>])</p>
                    </div>
                    
                    <div class="interactive-section">
                        <h3>5-1. ë°ì´í„° íƒ€ì… ë³€í™˜</h3>
                        <select id="typeChangeColumn">
                            <option value="">ì»¬ëŸ¼ ì„ íƒ</option>
                        </select>
                        <select id="targetType">
                            <option value="number">ìˆ«ì (number)</option>
                            <option value="string">ë¬¸ì (string)</option>
                        </select>
                        <button onclick="changeDataType()">íƒ€ì… ë³€í™˜</button>
                        
                        <h3>5-2. ìƒˆë¡œìš´ ì»¬ëŸ¼ ìƒì„±</h3>
                        <input type="text" id="newColumnName" placeholder="ìƒˆ ì»¬ëŸ¼ëª…">
                        <select id="calcColumn1">
                            <option value="">ì»¬ëŸ¼1 ì„ íƒ</option>
                        </select>
                        <select id="operator">
                            <option value="+">ë”í•˜ê¸° (+)</option>
                            <option value="-">ë¹¼ê¸° (-)</option>
                            <option value="*">ê³±í•˜ê¸° (*)</option>
                            <option value="/">ë‚˜ëˆ„ê¸° (/)</option>
                        </select>
                        <select id="calcColumn2">
                            <option value="">ì»¬ëŸ¼2 ì„ íƒ</option>
                        </select>
                        <button onclick="createNewColumn()">ìƒˆ ì»¬ëŸ¼ ìƒì„±</button>
                        
                        <h3>5-3. ê·¸ë£¹í•‘ ë° ì§‘ê³„</h3>
                        <select id="groupColumn">
                            <option value="">ê·¸ë£¹ ì»¬ëŸ¼ ì„ íƒ</option>
                        </select>
                        <select id="aggColumn">
                            <option value="">ì§‘ê³„ ì»¬ëŸ¼ ì„ íƒ</option>
                        </select>
                        <select id="aggFunction">
                            <option value="mean">í‰ê·  (mean)</option>
                            <option value="sum">í•©ê³„ (sum)</option>
                            <option value="count">ê°œìˆ˜ (count)</option>
                            <option value="median">ì¤‘ì•™ê°’ (median)</option>
                        </select>
                        <button onclick="performGroupBy()">ê·¸ë£¹ë³„ ì§‘ê³„</button>
                        
                        <div class="output-area" id="transformOutput"></div>
                    </div>
                </div>
                
                <!-- Step 6: ì‹œê°í™” -->
                <div class="step-content" id="step6">
                    <h2>ğŸ“ˆ 6ë‹¨ê³„: ë°ì´í„° ì‹œê°í™”</h2>
                    
                    <div class="info-box">
                        <strong>ğŸ’¡ í•™ìŠµ ëª©í‘œ:</strong> íˆìŠ¤í† ê·¸ë¨, ì‚°ì ë„, ë§‰ëŒ€ê·¸ë˜í”„ ë“± ë‹¤ì–‘í•œ ì‹œê°í™” ë°©ë²•ì„ ë°°ì›ë‹ˆë‹¤.
                    </div>
                    
                    <div class="code-block">
<p><span class="comment"># íˆìŠ¤í† ê·¸ë¨ - ìˆ˜ì¹˜í˜• ë°ì´í„°ì˜ ë¶„í¬ í™•ì¸</span></p>
<p>df[<span class="string">"ì»¬ëŸ¼ëª…"</span>].<span class="function">hist</span>()</p>
<p>plt.<span class="function">show</span>()</p>

<p><span class="comment"># ì‚°ì ë„ - ë‘ ìˆ˜ì¹˜í˜• ë³€ìˆ˜ ê°„ì˜ ê´€ê³„</span></p>
<p>plt.<span class="function">scatter</span>(df[<span class="string">"ì»¬ëŸ¼1"</span>], df[<span class="string">"ì»¬ëŸ¼2"</span>])</p>
<p>plt.<span class="function">xlabel</span>(<span class="string">"Xì¶• ì œëª©"</span>)</p>
<p>plt.<span class="function">ylabel</span>(<span class="string">"Yì¶• ì œëª©"</span>)</p>
<p>plt.<span class="function">title</span>(<span class="string">"ê·¸ë˜í”„ ì œëª©"</span>)</p>
<p>plt.<span class="function">show</span>()</p>

<p><span class="comment"># ë§‰ëŒ€ê·¸ë˜í”„ - ë²”ì£¼í˜• ë°ì´í„°ì˜ ë¹ˆë„ ë¹„êµ</span></p>
<p>sns.<span class="function">countplot</span>(x=<span class="string">"ë²”ì£¼ì»¬ëŸ¼"</span>, data=df)</p>
<p>sns.<span class="function">barplot</span>(x=<span class="string">"ë²”ì£¼ì»¬ëŸ¼"</span>, y=<span class="string">"ìˆ˜ì¹˜ì»¬ëŸ¼"</span>, data=df)</p>

<p><span class="comment"># ë°•ìŠ¤í”Œë¡¯ - ë°ì´í„° ë¶„í¬, ì¤‘ì•™ê°’, ì´ìƒì¹˜ í™•ì¸</span></p>
<p>sns.<span class="function">boxplot</span>(x=<span class="string">"ë²”ì£¼ì»¬ëŸ¼"</span>, y=<span class="string">"ìˆ˜ì¹˜ì»¬ëŸ¼"</span>, data=df)</p>

<p><span class="comment"># íŒŒì´ì°¨íŠ¸ - ì „ì²´ ëŒ€ë¹„ ê° ë²”ì£¼ì˜ ë¹„ìœ¨</span></p>
<p>df[<span class="string">"ì»¬ëŸ¼ëª…"</span>].<span class="function">value_counts</span>().<span class="function">plot</span>.<span class="function">pie</span>(autopct=<span class="string">'%.1f%%'</span>)</p>

<p><span class="comment"># ìƒê´€ê´€ê³„ íˆíŠ¸ë§µ - ë‹¤ì¤‘ ë³€ìˆ˜ ê°„ ìƒê´€ê³„ìˆ˜</span></p>
<p>sns.<span class="function">heatmap</span>(df.<span class="function">corr</span>(), annot=<span class="keyword">True</span>, cmap=<span class="string">"coolwarm"</span>)</p>
<p>plt.<span class="function">show</span>()</p>
                    </div>
                    
                    <div class="interactive-section">
                        <h3>ì‹¤ìŠµ: ë°ì´í„° ì‹œê°í™”í•˜ê¸°</h3>
                        
                        <div>
                            <h4>ë‹¨ì¼ ì»¬ëŸ¼ ì‹œê°í™”:</h4>
                            <select id="vizColumn1">
                                <option value="">ì»¬ëŸ¼ ì„ íƒ</option>
                            </select>
                            <button onclick="drawHistogram()">íˆìŠ¤í† ê·¸ë¨</button>
                            <button onclick="drawBarChart()">ë§‰ëŒ€ê·¸ë˜í”„</button>
                            <button onclick="drawPieChart()">íŒŒì´ì°¨íŠ¸</button>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <h4>ë‘ ì»¬ëŸ¼ ê´€ê³„ ì‹œê°í™”:</h4>
                            <select id="vizColumnX">
                                <option value="">Xì¶• ì»¬ëŸ¼</option>
                            </select>
                            <select id="vizColumnY">
                                <option value="">Yì¶• ì»¬ëŸ¼</option>
                            </select>
                            <button onclick="drawScatter()">ì‚°ì ë„</button>
                            <button onclick="drawBoxPlot()">ë°•ìŠ¤í”Œë¡¯</button>
                        </div>
                        
                        <div class="chart-container" id="chartOutput"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentData = null;
        let originalData = null;
        
        // ìƒ˜í”Œ ë°ì´í„° ìƒì„±
        function loadSampleData() {
            const sampleCSV = `ì´ë¦„,ë‚˜ì´,ì„±ë³„,ì ìˆ˜,ì§€ì—­,ìˆ˜ì…
ê¹€ì² ìˆ˜,25,ë‚¨,85,ì„œìš¸,3500
ì´ì˜í¬,30,ì—¬,92,ë¶€ì‚°,4200
ë°•ë¯¼ìˆ˜,28,ë‚¨,78,ëŒ€êµ¬,3800
ì •ìˆ˜ì§„,35,ì—¬,88,ì¸ì²œ,4500
ìµœì§€í›ˆ,22,ë‚¨,95,ì„œìš¸,3200
ê°•ë¯¸ì˜,27,ì—¬,82,ë¶€ì‚°,3900
ì„ë™í˜„,31,ë‚¨,75,ê´‘ì£¼,4100
í•œì§€ì€,29,ì—¬,90,ëŒ€ì „,4000
ìœ¤ì„±í˜¸,26,ë‚¨,87,ìš¸ì‚°,3600
ì¡°í˜„ì•„,33,ì—¬,79,ì„œìš¸,4300
ì†¡ë¯¼ì¤€,24,ë‚¨,,ëŒ€êµ¬,3400
ì´ì„œì—°,32,ì—¬,86,ì¸ì²œ,
ë°•ì¤€í˜•,29,ë‚¨,81,ë¶€ì‚°,3700
ê¹€í•˜ëŠ˜,27,ì—¬,93,ì„œìš¸,4400`;
            
            Papa.parse(sampleCSV, {
                header: true,
                dynamicTyping: true,
                complete: function(results) {
                    currentData = results.data;
                    originalData = JSON.parse(JSON.stringify(results.data));
                    document.getElementById('loadOutput').innerHTML = 
                        `<strong>âœ… ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ ì™„ë£Œ!</strong><br>ì´ ${currentData.length}í–‰ì˜ ë°ì´í„°ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.<br>ê²°ì¸¡ì¹˜ê°€ í¬í•¨ëœ ìƒ˜í”Œ ë°ì´í„°ì…ë‹ˆë‹¤.`;
                    updateColumnSelects();
                }
            });
        }
        
        // CSV íŒŒì¼ ì—…ë¡œë“œ
        document.getElementById('csvFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                Papa.parse(file, {
                    header: true,
                    dynamicTyping: true,
                    complete: function(results) {
                        currentData = results.data;
                        originalData = JSON.parse(JSON.stringify(results.data));
                        document.getElementById('loadOutput').innerHTML = 
                            `<strong>âœ… íŒŒì¼ ë¡œë“œ ì™„ë£Œ!</strong><br>ì´ ${currentData.length}í–‰ì˜ ë°ì´í„°ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.`;
                        updateColumnSelects();
                    }
                });
            }
        });
        
        // ì»¬ëŸ¼ ì„ íƒ ì˜µì…˜ ì—…ë°ì´íŠ¸
        function updateColumnSelects() {
            if (!currentData || currentData.length === 0) return;
            
            const columns = Object.keys(currentData[0]);
            const selects = ['columnSelect', 'groupColumn', 'aggColumn', 'vizColumn1', 
                            'vizColumnX', 'vizColumnY', 'typeChangeColumn', 'calcColumn1', 'calcColumn2'];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                select.innerHTML = '<option value="">ì»¬ëŸ¼ ì„ íƒ</option>';
                columns.forEach(col => {
                    select.innerHTML += `<option value="${col}">${col}</option>`;
                });
            });
        }
        
        // Step 2: ë°ì´í„° í™•ì¸
        function showHead() {
            if (!currentData) {
                alert('ë¨¼ì € ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì„¸ìš”!');
                return;
            }
            
            const output = document.getElementById('previewOutput');
            const head = currentData.slice(0, 5);
            const columns = Object.keys(head[0]);
            
            let html = '<h4>df.head() - ìƒìœ„ 5í–‰</h4><table><tr>';
            columns.forEach(col => html += `<th>${col}</th>`);
            html += '</tr>';
            
            head.forEach(row => {
                html += '<tr>';
                columns.forEach(col => {
                    const value = row[col];
                    html += `<td>${value !== null && value !== undefined && value !== '' ? value : '<span style="color:red;">NaN</span>'}</td>`;
                });
                html += '</tr>';
            });
            html += '</table>';
            output.innerHTML = html;
        }
        
        function showInfo() {
            if (!currentData) {
                alert('ë¨¼ì € ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì„¸ìš”!');
                return;
            }
            
            const output = document.getElementById('previewOutput');
            const columns = Object.keys(currentData[0]);
            
            let html = '<h4>df.info() - ë°ì´í„° ì •ë³´</h4>';
            html += `<p><strong>í–‰ ê°œìˆ˜:</strong> ${currentData.length}</p>`;
            html += `<p><strong>ì—´ ê°œìˆ˜:</strong> ${columns.length}</p>`;
            html += '<p><strong>ì»¬ëŸ¼ ì •ë³´:</strong></p><table><tr><th>ì»¬ëŸ¼ëª…</th><th>ë°ì´í„° íƒ€ì…</th><th>Non-Null ê°œìˆ˜</th></tr>';
            
            columns.forEach(col => {
                const nonNull = currentData.filter(row => row[col] != null && row[col] !== '').length;
                const sampleValue = currentData.find(row => row[col] != null && row[col] !== '');
                const dataType = sampleValue ? typeof sampleValue[col] : 'unknown';
                html += `<tr><td>${col}</td><td>${dataType}</td><td>${nonNull}</td></tr>`;
            });
            html += '</table>';
            output.innerHTML = html;
        }
        
        function showShape() {
            if (!currentData) {
                alert('ë¨¼ì € ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì„¸ìš”!');
                return;
            }
            
            const output = document.getElementById('previewOutput');
            const columns = Object.keys(currentData[0]);
            output.innerHTML = `<h4>ë°ì´í„° í¬ê¸° (shape)</h4>
                <p><strong>í–‰ Ã— ì—´:</strong> ${currentData.length} Ã— ${columns.length}</p>`;
        }
        
        // Step 3: ê²°ì¸¡ì¹˜ ì²˜ë¦¬
        function checkMissing() {
            if (!currentData) {
                alert('ë¨¼ì € ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì„¸ìš”!');
                return;
            }
            
            const output = document.getElementById('missingOutput');
            const columns = Object.keys(currentData[0]);
            
            let html = '<h4>ê²°ì¸¡ì¹˜ ê°œìˆ˜ (isna().sum())</h4><div class="column-list">';
            let hasMissing = false;
            
            columns.forEach(col => {
                const missing = currentData.filter(row => row[col] == null || row[col] === '').length;
                const className = missing > 0 ? 'column-item has-missing' : 'column-item';
                html += `<div class="${className}"><strong>${col}:</strong> ${missing}ê°œ`;
                if (missing > 0) {
                    html += ` âš ï¸`;
                    hasMissing = true;
                }
                html += '</div>';
            });
            html += '</div>';
            
            output.innerHTML = html;
            
            if (hasMissing) {
                document.getElementById('missingDisplay').style.display = 'block';
            } else {
                document.getElementById('missingDisplay').style.display = 'none';
                output.innerHTML += '<div class="info-box"><strong>âœ… ê²°ì¸¡ì¹˜ê°€ ì—†ìŠµë‹ˆë‹¤!</strong></div>';
            }
        }
        
        function applyMissingTreatment() {
            if (!currentData) return;
            
            const method = document.querySelector('input[name="missingMethod"]:checked').value;
            const beforeCount = currentData.length;
            
            if (method === 'drop') {
                // ê²°ì¸¡ì¹˜ ì‚­ì œ
                currentData = currentData.filter(row => {
                    return Object.values(row).every(val => val != null && val !== '');
                });
                
                document.getElementById('missingOutput').innerHTML = `
                    <div class="info-box">
                        <h4>âœ… dropna() ì‹¤í–‰ ì™„ë£Œ</h4>
                        <p><strong>ì´ì „ í–‰ ìˆ˜:</strong> ${beforeCount}í–‰</p>
                        <p><strong>ì´í›„ í–‰ ìˆ˜:</strong> ${currentData.length}í–‰</p>
                        <p><strong>ì‚­ì œëœ í–‰:</strong> ${beforeCount - currentData.length}í–‰</p>
                    </div>`;
                
            } else if (method === 'fillZero') {
                // 0ìœ¼ë¡œ ì±„ìš°ê¸°
                currentData = currentData.map(row => {
                    const newRow = {};
                    Object.keys(row).forEach(key => {
                        newRow[key] = (row[key] == null || row[key] === '') ? 0 : row[key];
                    });
                    return newRow;
                });
                
                document.getElementById('missingOutput').innerHTML = `
                    <div class="info-box">
                        <h4>âœ… fillna(0) ì‹¤í–‰ ì™„ë£Œ</h4>
                        <p>ëª¨ë“  ê²°ì¸¡ì¹˜ë¥¼ 0ìœ¼ë¡œ ì±„ì› ìŠµë‹ˆë‹¤.</p>
                    </div>`;
                
            } else if (method === 'fillMean') {
                // í‰ê· ê°’ìœ¼ë¡œ ì±„ìš°ê¸°
                const columns = Object.keys(currentData[0]);
                const means = {};
                
                columns.forEach(col => {
                    const values = currentData.map(row => row[col]).filter(v => v != null && v !== '' && typeof v === 'number');
                    if (values.length > 0) {
                        means[col] = values.reduce((a, b) => a + b, 0) / values.length;
                    }
                });
                
                currentData = currentData.map(row => {
                    const newRow = {};
                    Object.keys(row).forEach(key => {
                        if ((row[key] == null || row[key] === '') && means[key] !== undefined) {
                            newRow[key] = means[key];
                        } else {
                            newRow[key] = row[key];
                        }
                    });
                    return newRow;
                });
                
                document.getElementById('missingOutput').innerHTML = `
                    <div class="info-box">
                        <h4>âœ… fillna(mean) ì‹¤í–‰ ì™„ë£Œ</h4>
                        <p>ìˆ˜ì¹˜í˜• ì»¬ëŸ¼ì˜ ê²°ì¸¡ì¹˜ë¥¼ í‰ê· ê°’ìœ¼ë¡œ ì±„ì› ìŠµë‹ˆë‹¤.</p>
                    </div>`;
            }
            
            document.getElementById('missingDisplay').style.display = 'none';
            updateColumnSelects();
        }
        
        // Step 4: ê¸°ì´ˆ í†µê³„
        function showDescribe() {
            if (!currentData) {
                alert('ë¨¼ì € ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì„¸ìš”!');
                return;
            }
            
            const output = document.getElementById('statsOutput');
            const columns = Object.keys(currentData[0]);
            const numericCols = columns.filter(col => 
                typeof currentData.find(row => row[col] != null)?.[col] === 'number'
            );
            
            if (numericCols.length === 0) {
                output.innerHTML = '<p>ìˆ˜ì¹˜í˜• ì»¬ëŸ¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            let html = '<h4>df.describe() - ê¸°ì´ˆ í†µê³„</h4><table><tr><th>í†µê³„ëŸ‰</th>';
            numericCols.forEach(col => html += `<th>${col}</th>`);
            html += '</tr>';
            
            const stats = ['ê°œìˆ˜', 'í‰ê· ', 'ì¤‘ì•™ê°’', 'ìµœì†Œê°’', 'ìµœëŒ€ê°’', 'í‘œì¤€í¸ì°¨'];
            stats.forEach(stat => {
                html += `<tr><td><strong>${stat}</strong></td>`;
                numericCols.forEach(col => {
                    const values = currentData.map(row => row[col]).filter(v => v != null && typeof v === 'number');
                    let value;
                    
                    if (stat === 'ê°œìˆ˜') value = values.length;
                    else if (stat === 'í‰ê· ') value = (values.reduce((a,b) => a+b, 0) / values.length).toFixed(2);
                    else if (stat === 'ì¤‘ì•™ê°’') {
                        const sorted = [...values].sort((a,b) => a-b);
                        value = sorted[Math.floor(sorted.length/2)].toFixed(2);
                    }
                    else if (stat === 'ìµœì†Œê°’') value = Math.min(...values).toFixed(2);
                    else if (stat === 'ìµœëŒ€ê°’') value = Math.max(...values).toFixed(2);
                    else if (stat === 'í‘œì¤€í¸ì°¨') {
                        const mean = values.reduce((a,b) => a+b, 0) / values.length;
                        const variance = values.reduce((a,b) => a + Math.pow(b - mean, 2), 0) / values.length;
                        value = Math.sqrt(variance).toFixed(2);
                    }
                    
                    html += `<td>${value}</td>`;
                });
                html += '</tr>';
            });
            html += '</table>';
            output.innerHTML = html;
        }
        
        function showCorrelation() {
            if (!currentData) {
                alert('ë¨¼ì € ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì„¸ìš”!');
                return;
            }
            
            const columns = Object.keys(currentData[0]);
            const numericCols = columns.filter(col => 
                typeof currentData.find(row => row[col] != null)?.[col] === 'number'
            );
            
            if (numericCols.length < 2) {
                document.getElementById('statsOutput').innerHTML = '<p>ìƒê´€ê³„ìˆ˜ë¥¼ ê³„ì‚°í•˜ë ¤ë©´ ìˆ˜ì¹˜í˜• ì»¬ëŸ¼ì´ 2ê°œ ì´ìƒ í•„ìš”í•©ë‹ˆë‹¤.</p>';
                return;
            }
            
            // ìƒê´€ê³„ìˆ˜ ê³„ì‚°
            const corrMatrix = {};
            numericCols.forEach(col1 => {
                corrMatrix[col1] = {};
                numericCols.forEach(col2 => {
                    const values1 = [];
                    const values2 = [];
                    
                    currentData.forEach(row => {
                        if (row[col1] != null && row[col2] != null && 
                            typeof row[col1] === 'number' && typeof row[col2] === 'number') {
                            values1.push(row[col1]);
                            values2.push(row[col2]);
                        }
                    });
                    
                    if (values1.length > 0) {
                        const mean1 = values1.reduce((a,b) => a+b, 0) / values1.length;
                        const mean2 = values2.reduce((a,b) => a+b, 0) / values2.length;
                        
                        let numerator = 0;
                        let denominator1 = 0;
                        let denominator2 = 0;
                        
                        for (let i = 0; i < values1.length; i++) {
                            numerator += (values1[i] - mean1) * (values2[i] - mean2);
                            denominator1 += Math.pow(values1[i] - mean1, 2);
                            denominator2 += Math.pow(values2[i] - mean2, 2);
                        }
                        
                        const corr = numerator / Math.sqrt(denominator1 * denominator2);
                        corrMatrix[col1][col2] = corr;
                    }
                });
            });
            
            // íˆíŠ¸ë§µ ë°ì´í„° ì¤€ë¹„
            const zValues = numericCols.map(col1 => 
                numericCols.map(col2 => corrMatrix[col1][col2])
            );
            
            const trace = {
                z: zValues,
                x: numericCols,
                y: numericCols,
                type: 'heatmap',
                colorscale: [
                    [0, '#0000ff'],
                    [0.5, '#ffffff'],
                    [1, '#ff0000']
                ],
                zmin: -1,
                zmax: 1,
                text: zValues.map(row => row.map(val => val.toFixed(2))),
                texttemplate: '%{text}',
                textfont: {
                    size: 12
                }
            };
            
            const layout = {
                title: 'ìƒê´€ê³„ìˆ˜ íˆíŠ¸ë§µ (Correlation Heatmap)',
                xaxis: { title: '' },
                yaxis: { title: '' },
                width: 600,
                height: 600
            };
            
            // ê¸°ì¡´ í…Œì´ë¸”ë„ í‘œì‹œ
            let html = '<h4>df.corr() - ìƒê´€ê³„ìˆ˜ í–‰ë ¬</h4>';
            html += '<p>-1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ìŒì˜ ìƒê´€ê´€ê³„, +1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ì–‘ì˜ ìƒê´€ê´€ê³„</p>';
            html += '<table><tr><th></th>';
            numericCols.forEach(col => html += `<th>${col}</th>`);
            html += '</tr>';
            
            numericCols.forEach(col1 => {
                html += `<tr><th>${col1}</th>`;
                numericCols.forEach(col2 => {
                    const corr = corrMatrix[col1][col2].toFixed(3);
                    const color = corr > 0.7 ? '#ffcccc' : corr < -0.7 ? '#ccccff' : '';
                    html += `<td style="background:${color}">${corr}</td>`;
                });
                html += '</tr>';
            });
            html += '</table>';
            
            html += '<div id="corrHeatmap" style="margin-top: 20px;"></div>';
            document.getElementById('statsOutput').innerHTML = html;
            
            // íˆíŠ¸ë§µ ê·¸ë¦¬ê¸°
            Plotly.newPlot('corrHeatmap', [trace], layout);
        }
        
        function showColumnStats() {
            const col = document.getElementById('columnSelect').value;
            if (!col || !currentData) return;
            
            const output = document.getElementById('statsOutput');
            const values = currentData.map(row => row[col]).filter(v => v != null && v !== '');
            
            if (values.length === 0) {
                output.innerHTML = '<p>ì„ íƒí•œ ì»¬ëŸ¼ì— ìœ íš¨í•œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            if (typeof values[0] === 'number') {
                const mean = (values.reduce((a,b) => a+b, 0) / values.length).toFixed(2);
                const sorted = [...values].sort((a,b) => a-b);
                const median = sorted[Math.floor(sorted.length/2)].toFixed(2);
                const min = Math.min(...values).toFixed(2);
                const max = Math.max(...values).toFixed(2);
                const stdDev = Math.sqrt(values.reduce((a,b) => a + Math.pow(b - mean, 2), 0) / values.length).toFixed(2);
                
                output.innerHTML = `<h4>${col} ì»¬ëŸ¼ í†µê³„</h4>
                    <p><strong>í‰ê·  (mean):</strong> ${mean}</p>
                    <p><strong>ì¤‘ì•™ê°’ (median):</strong> ${median}</p>
                    <p><strong>ìµœì†Œê°’ (min):</strong> ${min}</p>
                    <p><strong>ìµœëŒ€ê°’ (max):</strong> ${max}</p>
                    <p><strong>í‘œì¤€í¸ì°¨ (std):</strong> ${stdDev}</p>
                    <p><strong>ë°ì´í„° ê°œìˆ˜:</strong> ${values.length}</p>`;
            } else {
                const counts = {};
                values.forEach(v => counts[v] = (counts[v] || 0) + 1);
                
                let html = `<h4>${col} ì»¬ëŸ¼ value_counts()</h4><table><tr><th>ê°’</th><th>ë¹ˆë„</th><th>ë¹„ìœ¨</th></tr>`;
                const total = values.length;
                Object.entries(counts).sort((a,b) => b[1] - a[1]).forEach(([key, count]) => {
                    const percentage = ((count / total) * 100).toFixed(1);
                    html += `<tr><td>${key}</td><td>${count}</td><td>${percentage}%</td></tr>`;
                });
                html += '</table>';
                output.innerHTML = html;
            }
        }
        
        // Step 5: ë°ì´í„° ê°€ê³µ
        function changeDataType() {
            const col = document.getElementById('typeChangeColumn').value;
            const targetType = document.getElementById('targetType').value;
            
            if (!col || !currentData) {
                alert('ì»¬ëŸ¼ì„ ì„ íƒí•˜ê³  ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì„¸ìš”!');
                return;
            }
            
            try {
                currentData = currentData.map(row => {
                    const newRow = {...row};
                    if (targetType === 'number') {
                        newRow[col] = parseFloat(row[col]) || 0;
                    } else if (targetType === 'string') {
                        newRow[col] = String(row[col]);
                    }
                    return newRow;
                });
                
                document.getElementById('transformOutput').innerHTML = `
                    <div class="info-box">
                        <h4>âœ… ë°ì´í„° íƒ€ì… ë³€í™˜ ì™„ë£Œ</h4>
                        <p><strong>ì»¬ëŸ¼:</strong> ${col}</p>
                        <p><strong>ë³€í™˜:</strong> ${targetType}</p>
                    </div>`;
            } catch (error) {
                alert('íƒ€ì… ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }
        
        function createNewColumn() {
            const newColName = document.getElementById('newColumnName').value;
            const col1 = document.getElementById('calcColumn1').value;
            const operator = document.getElementById('operator').value;
            const col2 = document.getElementById('calcColumn2').value;
            
            if (!newColName || !col1 || !col2 || !currentData) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•˜ê³  ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì„¸ìš”!');
                return;
            }
            
            try {
                currentData = currentData.map(row => {
                    const newRow = {...row};
                    const val1 = parseFloat(row[col1]) || 0;
                    const val2 = parseFloat(row[col2]) || 0;
                    
                    switch(operator) {
                        case '+': newRow[newColName] = val1 + val2; break;
                        case '-': newRow[newColName] = val1 - val2; break;
                        case '*': newRow[newColName] = val1 * val2; break;
                        case '/': newRow[newColName] = val2 !== 0 ? val1 / val2 : 0; break;
                    }
                    
                    return newRow;
                });
                
                document.getElementById('transformOutput').innerHTML = `
                    <div class="info-box">
                        <h4>âœ… ìƒˆë¡œìš´ ì»¬ëŸ¼ ìƒì„± ì™„ë£Œ</h4>
                        <p><strong>ì»¬ëŸ¼ëª…:</strong> ${newColName}</p>
                        <p><strong>ê³„ì‚°ì‹:</strong> ${col1} ${operator} ${col2}</p>
                    </div>`;
                
                updateColumnSelects();
            } catch (error) {
                alert('ì»¬ëŸ¼ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }
        
        function performGroupBy() {
            if (!currentData) {
                alert('ë¨¼ì € ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì„¸ìš”!');
                return;
            }
            
            const groupCol = document.getElementById('groupColumn').value;
            const aggCol = document.getElementById('aggColumn').value;
            const aggFunc = document.getElementById('aggFunction').value;
            
            if (!groupCol || !aggCol) {
                alert('ê·¸ë£¹ ì»¬ëŸ¼ê³¼ ì§‘ê³„ ì»¬ëŸ¼ì„ ëª¨ë‘ ì„ íƒí•˜ì„¸ìš”!');
                return;
            }
            
            const groups = {};
            currentData.forEach(row => {
                const key = row[groupCol];
                if (!groups[key]) groups[key] = [];
                if (row[aggCol] != null && typeof row[aggCol] === 'number') {
                    groups[key].push(row[aggCol]);
                }
            });
            
            const output = document.getElementById('transformOutput');
            let html = `<h4>df.groupby("${groupCol}")["${aggCol}"].${aggFunc}()</h4>`;
            html += '<table><tr><th>' + groupCol + '</th><th>' + aggFunc + '</th><th>ê°œìˆ˜</th></tr>';
            
            Object.entries(groups).forEach(([key, values]) => {
                let result;
                if (aggFunc === 'mean') {
                    result = (values.reduce((a,b) => a+b, 0) / values.length).toFixed(2);
                } else if (aggFunc === 'sum') {
                    result = values.reduce((a,b) => a+b, 0).toFixed(2);
                } else if (aggFunc === 'count') {
                    result = values.length;
                } else if (aggFunc === 'median') {
                    const sorted = [...values].sort((a,b) => a-b);
                    result = sorted[Math.floor(sorted.length/2)].toFixed(2);
                }
                
                html += `<tr><td>${key}</td><td>${result}</td><td>${values.length}</td></tr>`;
            });
            html += '</table>';
            output.innerHTML = html;
        }
        
        // Step 6: ì‹œê°í™”
        function drawHistogram() {
            const col = document.getElementById('vizColumn1').value;
            if (!col || !currentData) {
                alert('ì»¬ëŸ¼ì„ ì„ íƒí•˜ê³  ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì„¸ìš”!');
                return;
            }
            
            const values = currentData.map(row => row[col]).filter(v => v != null && typeof v === 'number');
            
            if (values.length === 0) {
                alert('ìˆ˜ì¹˜í˜• ë°ì´í„°ê°€ ìˆëŠ” ì»¬ëŸ¼ì„ ì„ íƒí•˜ì„¸ìš”!');
                return;
            }
            
            const trace = {
                x: values,
                type: 'histogram',
                marker: { 
                    color: '#667eea',
                    line: {
                        color: '#ffffff',
                        width: 1
                    }
                },
                nbinsx: 15
            };
            
            const layout = {
                title: `${col} íˆìŠ¤í† ê·¸ë¨ (Histogram)`,
                xaxis: { title: col },
                yaxis: { title: 'ë¹ˆë„ (Frequency)' },
                showlegend: false
            };
            
            Plotly.newPlot('chartOutput', [trace], layout);
        }
        
        function drawBarChart() {
            const col = document.getElementById('vizColumn1').value;
            if (!col || !currentData) {
                alert('ì»¬ëŸ¼ì„ ì„ íƒí•˜ê³  ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì„¸ìš”!');
                return;
            }
            
            const values = currentData.map(row => row[col]).filter(v => v != null && v !== '');
            const counts = {};
            values.forEach(v => counts[v] = (counts[v] || 0) + 1);
            
            const sorted = Object.entries(counts).sort((a,b) => b[1] - a[1]);
            
            const trace = {
                x: sorted.map(([key]) => String(key)),
                y: sorted.map(([, count]) => count),
                type: 'bar',
                marker: { 
                    color: '#667eea',
                    line: {
                        color: '#ffffff',
                        width: 1
                    }
                }
            };
            
            const layout = {
                title: `${col} ë§‰ëŒ€ê·¸ë˜í”„ (Bar Chart)`,
                xaxis: { title: col },
                yaxis: { title: 'ë¹ˆë„ (Count)' },
                showlegend: false
            };
            
            Plotly.newPlot('chartOutput', [trace], layout);
        }
        
        function drawPieChart() {
            const col = document.getElementById('vizColumn1').value;
            if (!col || !currentData) {
                alert('ì»¬ëŸ¼ì„ ì„ íƒí•˜ê³  ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì„¸ìš”!');
                return;
            }
            
            const values = currentData.map(row => row[col]).filter(v => v != null && v !== '');
            const counts = {};
            values.forEach(v => counts[v] = (counts[v] || 0) + 1);
            
            const trace = {
                labels: Object.keys(counts),
                values: Object.values(counts),
                type: 'pie',
                marker: {
                    colors: ['#667eea', '#764ba2', '#f093fb', '#4facfe', '#43e97b', '#fa709a']
                },
                textinfo: 'label+percent',
                textposition: 'outside'
            };
            
            const layout = {
                title: `${col} íŒŒì´ì°¨íŠ¸ (Pie Chart)`,
                showlegend: true
            };
            
            Plotly.newPlot('chartOutput', [trace], layout);
        }
        
        function drawScatter() {
            const colX = document.getElementById('vizColumnX').value;
            const colY = document.getElementById('vizColumnY').value;
            
            if (!colX || !colY || !currentData) {
                alert('Xì¶•ê³¼ Yì¶• ì»¬ëŸ¼ì„ ëª¨ë‘ ì„ íƒí•˜ê³  ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì„¸ìš”!');
                return;
            }
            
            const xValues = [];
            const yValues = [];
            
            currentData.forEach(row => {
                if (row[colX] != null && row[colY] != null && 
                    typeof row[colX] === 'number' && typeof row[colY] === 'number') {
                    xValues.push(row[colX]);
                    yValues.push(row[colY]);
                }
            });
            
            if (xValues.length === 0) {
                alert('ë‘ ì»¬ëŸ¼ ëª¨ë‘ ìˆ˜ì¹˜í˜• ë°ì´í„°ê°€ ìˆì–´ì•¼ í•©ë‹ˆë‹¤!');
                return;
            }
            
            const trace = {
                x: xValues,
                y: yValues,
                mode: 'markers',
                type: 'scatter',
                marker: { 
                    size: 10,
                    color: '#667eea',
                    line: {
                        color: '#ffffff',
                        width: 1
                    }
                }
            };
            
            const layout = {
                title: `${colX} vs ${colY} ì‚°ì ë„ (Scatter Plot)`,
                xaxis: { title: colX },
                yaxis: { title: colY },
                showlegend: false
            };
            
            Plotly.newPlot('chartOutput', [trace], layout);
        }
        
        function drawBoxPlot() {
            const colX = document.getElementById('vizColumnX').value;
            const colY = document.getElementById('vizColumnY').value;
            
            if (!colX || !colY || !currentData) {
                alert('Xì¶•ê³¼ Yì¶• ì»¬ëŸ¼ì„ ëª¨ë‘ ì„ íƒí•˜ê³  ë°ì´í„°ë¥¼ ë¡œë“œí•˜ì„¸ìš”!');
                return;
            }
            
            // Xì¶•ì€ ë²”ì£¼í˜•, Yì¶•ì€ ìˆ˜ì¹˜í˜•ìœ¼ë¡œ ê°€ì •
            const groups = {};
            currentData.forEach(row => {
                const key = row[colX];
                if (key != null && row[colY] != null && typeof row[colY] === 'number') {
                    if (!groups[key]) groups[key] = [];
                    groups[key].push(row[colY]);
                }
            });
            
            if (Object.keys(groups).length === 0) {
                alert('Yì¶• ì»¬ëŸ¼ì€ ìˆ˜ì¹˜í˜•ì´ì–´ì•¼ í•©ë‹ˆë‹¤!');
                return;
            }
            
            const traces = Object.entries(groups).map(([key, values]) => ({
                y: values,
                type: 'box',
                name: String(key),
                marker: { color: '#667eea' }
            }));
            
            const layout = {
                title: `${colX}ë³„ ${colY} ë°•ìŠ¤í”Œë¡¯ (Box Plot)`,
                yaxis: { title: colY },
                showlegend: true
            };
            
            Plotly.newPlot('chartOutput', traces, layout);
        }
        
        // ì‚¬ì´ë“œë°” ë„¤ë¹„ê²Œì´ì…˜
        document.querySelectorAll('.step').forEach(step => {
            step.addEventListener('click', function() {
                const stepNum = this.dataset.step;
                
                document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
                this.classList.add('active');
                
                document.querySelectorAll('.step-content').forEach(c => c.classList.remove('active'));
                document.getElementById('step' + stepNum).classList.add('active');
            });
        });
        
        // í˜ì´ì§€ ë¡œë“œì‹œ ìƒ˜í”Œ ë°ì´í„° ìë™ ë¡œë“œ
        window.addEventListener('load', function() {
            loadSampleData();
        });
    </script>
</body>
</html>
